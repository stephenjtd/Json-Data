

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
	<title>Library Test</title>
	<meta http-equiv="content-type" content="text/html;charset=utf-8" />
	<meta name="generator" content="Geany 1.36" />

<style>
.collapsible {
  background-color: white;
  color: blue;
  cursor: pointer;
  width: 100%;
  border: none;
  text-align: left;
  outline: none;
}

.content {
  padding: 0 18px;
  display: none;
  overflow: hidden;
}

/* Dropdown Button */
.dropbtn {
  background-color: #3498DB;
  color: white;
  margin-left: 174px;
  min-width: 130px;
  padding: 6px 10px;
  font-size: 16px;
  border: none;
  cursor: pointer;
}

/* Dropdown button on hover & focus */
.dropbtn:hover, .dropbtn:focus {
  background-color: #2980B9;
}

/* The container <div> - needed to position the dropdown content */
.dropdown {
  position: relative;
  display: inline-block;
}

/* Dropdown Content (Hidden by Default) */
.dropdown-content {
  display: none;
  margin-left: 174px;
  position: absolute;
  background-color: #f1f1f1;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

/* Links inside the dropdown */
.dropdown-content button {
  color: black;
  padding: 6px 16px;
  min-width: 160px;
  text-decoration: none;
  display: block;
}

/* Change color of dropdown links on hover */
.dropdown-content a:hover {background-color: #ddd}

.btn { 
  background-color: green;
  color: white;
  min-width: 130px;
  padding: 6px 10px;
  font-size: 16px;
  border: none;
  cursor: pointer;
}


/* Show the dropdown menu (use JS to add this class to the .dropdown-content container when the user clicks on the dropdown button) */
.show {display:block;}

</style>
</head>

<body>
	<p>Library Database</p>
	
	<input type="search" id="mysearch" name="mysearch">
        <input type="button" class="btn" id="title" value="Find Title" onclick="titlebtn()" />
	<p style ="margin-left: 174px"><input type="button" class="btn" id="author" value="Find Author" onclick="authorbtn()" /></p>
	
	<div id="dd_id"></div>
	<div id=<"dd_row></div>
	
		<div class="dropdown">
  		<input type="button" id="category_dropdown" class="dropbtn" value="Find Category" onclick="dropdownCategories()"/>
  		<div id="myDropdown1" class="dropdown-content">
   			<button class ="dropdown_btn" id="c1" onclick="dropdown_content_clicked1()" value ="Fiction">All Fiction</button>
			<button class ="dropdown_btn" id="c11" onclick="dropdown_content_clicked11()" value ="Contemporary Fiction">Contemporary Fiction</button>
    			<button class ="dropdown_btn" id="c8" onclick="dropdown_content_clicked8()" value ="Crime">Crime and Mystery</button>
    			<button class ="dropdown_btn" id="c15" onclick="dropdown_content_clicked15()" value ="Historical-fiction">Historical-fiction</button>
			<button class ="dropdown_btn" id="c13" onclick="dropdown_content_clicked13()" value ="Adult">Adult</button>
    			<button class ="dropdown_btn" id="c14" onclick="dropdown_content_clicked14()" value ="Romance">Romance</button>
    			<button class ="dropdown_btn" id="c9" onclick="dropdown_content_clicked9()" value ="Science Fiction">Science Fiction</button>
			<button class ="dropdown_btn" id="c10" onclick="dropdown_content_clicked10()" value ="Fantasy">Fantasy</button>
			<button class ="dropdown_btn" id="c23" onclick="dropdown_content_clicked23()" value ="Thriller">Thriller</button>
			<button class ="dropdown_btn" id="c16" onclick="dropdown_content_clicked16()" value ="Young-adult">Young-adult</button>
    			<button class ="dropdown_btn" id="c21" onclick="dropdown_content_clicked21()" value ="Short Stories">Short Stories</button>
    			<button class ="dropdown_btn" id="c20" onclick="dropdown_content_clicked20()" value ="Anthologies">Anthologies</button>
    			<button class ="dropdown_btn" id="c2" onclick="dropdown_content_clicked2()" value ="Poetry">Poetry</button>
    			<button class ="dropdown_btn" id="c3" onclick="dropdown_content_clicked3()" value ="Drama">Drama</button>
			<button class ="dropdown_btn" id="c12" onclick="dropdown_content_clicked12()" value ="Non-fiction">Non-fiction</button>
			<button class ="dropdown_btn" id="c6" onclick="dropdown_content_clicked6()" value ="Biography">Biography</button>
			<button class ="dropdown_btn" id="c7" onclick="dropdown_content_clicked7()" value ="Children">All Children's</button>
			<button class ="dropdown_btn" id="c19" onclick="dropdown_content_clicked19()" value ="Picture Book">Picture Books</button>
			<button class ="dropdown_btn" id="c24" onclick="dropdown_content_clicked24()" value ="Business">Business</button>
			<button class ="dropdown_btn" id="c18" onclick="dropdown_content_clicked18()" value ="Feminism">Feminism</button>
			<button class ="dropdown_btn" id="c5" onclick="dropdown_content_clicked5()" value ="History">History</button>
			<button class ="dropdown_btn" id="c4" onclick="dropdown_content_clicked4()" value ="Religio">Religion & Spirituality</button>
			<button class ="dropdown_btn" id="c17" onclick="dropdown_content_clicked17()" value ="Self-Help">Self-Help</button>
			<button class ="dropdown_btn" id="c22" onclick="dropdown_content_clicked22()" value ="Travel">Travel</button>
			<button class ="dropdown_btn" id="c100" onclick="dropdown_content_clicked100()" value ="Others">Other</button>
  		</div>
	</div><p>

	<div class="dropdown">
  		<input type="button" id="bookshelf_dropdown" class="dropbtn" value="Find Bookshelf" onclick="dropdownFunction()"/>
  		<div id="myDropdown" class="dropdown-content">
   			<button class ="dropdown_btn" id="d1" onclick="dropdown_content_clicked1()" value ="A1 Fiction">A1: Fiction (Also includes poetry, drama, religion, history & biography)</button>
    			<button class ="dropdown_btn" id="d2" onclick="dropdown_content_clicked2()" value ="A2 Fiction">A2: Fiction (Also includes non-fiction, drama, poetry, feminism & self-help)</button>
    			<button class ="dropdown_btn" id="d3" onclick="dropdown_content_clicked3()" value ="A3 Fiction">A3: Fiction (Also includes biography, religion, non-fiction & history)</button>
			<button class ="dropdown_btn" id="d4" onclick="dropdown_content_clicked4()" value ="A4 Children's">A4: Children's</button>
			<button class ="dropdown_btn" id="d5" onclick="dropdown_content_clicked5()" value ="A5 Children's">A5: Children's</button>
			<button class ="dropdown_btn" id="d6" onclick="dropdown_content_clicked6()" value ="A6 Children's">A6: Children's</button>
			<button class ="dropdown_btn" id="d7" onclick="dropdown_content_clicked7()" value ="B1 Fiction">B1: Fiction (Also includes religion, poetry, non-fiction, biography, history, gender studies & health)</button>
    			<button class ="dropdown_btn" id="d8" onclick="dropdown_content_clicked8()" value ="B2 Fiction">B2: Fiction (Also includes biography, history, poetry, travel & psychology)</button>
    			<button class ="dropdown_btn" id="d9" onclick="dropdown_content_clicked9()" value ="B3 Fiction">B3: Fiction (Also includes children's, poetry, religion & biography)</button>

			<button class ="dropdown_btn" id="d10" onclick="dropdown_content_clicked10()" value ="B4">B4</button>
			<button class ="dropdown_btn" id="d11" onclick="dropdown_content_clicked11()" value ="B5">B5</button>
			<button class ="dropdown_btn" id="d12" onclick="dropdown_content_clicked12()" value ="B6">B6</button>
			<button class ="dropdown_btn" id="d13" onclick="dropdown_content_clicked13()" value ="C1">C1</button>
    			<button class ="dropdown_btn" id="d14" onclick="dropdown_content_clicked14()" value ="C2">C2</button>
    			<button class ="dropdown_btn" id="d15" onclick="dropdown_content_clicked15()" value ="C3">C3</button>
			<button class ="dropdown_btn" id="d16" onclick="dropdown_content_clicked16()" value ="C4">C4</button>
			<button class ="dropdown_btn" id="d17" onclick="dropdown_content_clicked11()" value ="C5">C5</button>
			<button class ="dropdown_btn" id="d18" onclick="dropdown_content_clicked12()" value ="C6">C6</button>	
			<button class ="dropdown_btn" id="d19" onclick="dropdown_content_clicked19()" value ="D1">D1</button>
    			<button class ="dropdown_btn" id="d20" onclick="dropdown_content_clicked20()" value ="D2">D2</button>
    			<button class ="dropdown_btn" id="d21" onclick="dropdown_content_clicked21()" value ="D3">D3</button>
			<button class ="dropdown_btn" id="d22" onclick="dropdown_content_clicked16()" value ="D4">D4</button>
			<button class ="dropdown_btn" id="d23" onclick="dropdown_content_clicked11()" value ="D5">D5</button>
			<button class ="dropdown_btn" id="d24" onclick="dropdown_content_clicked12()" value ="D6">D6</button>
			
			<button class ="dropdown_btn" id="d100" onclick="dropdown_content_clicked100()" value ="Other">Other: Not sorted</button>
  		</div>
	</div></p>
	<p id="results_number"></p>
	<p id="mydata"></p>
	<div id="MainTable"></div>
	<!--Call up file once button is clicked-->
	<script src='https://cdnjs.cloudflare.com/ajax/libs/lodash.js/3.10.1/lodash.min.js' />
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.13.5/jszip.js"></script>
	<script type="text/javascript">
	
function dropdownFunction() {
  document.getElementById("myDropdown").classList.toggle("show");
  //for bookshelf dropdown
  var dd_id = document.getElementById("dd_id");
  dd_id.value = "bookshelf";
}

// Close the dropdown if the user clicks outside of it
window.onclick = function(event) {
  if (!event.target.matches('.dropbtn')) {
    var dropdowns = document.getElementsByClassName("dropdown-content");
    var i;
    for (i = 0; i < dropdowns.length; i++) {
      var openDropdown = dropdowns[i];
      if (openDropdown.classList.contains('show')) {
        openDropdown.classList.remove('show');
      }
    }
  }
}

function dropdownCategories() {
  document.getElementById("myDropdown1").classList.toggle("show");
  //for bookshelf dropdown
  var dd_id = document.getElementById("dd_id");
  dd_id.value = "category";
}

// Close the dropdown if the user clicks outside of it
window.onclick = function(event) {
  if (!event.target.matches('.dropbtn')) {
    var dropdowns = document.getElementsByClassName("dropdown-content");
    var i;
    for (i = 0; i < dropdowns.length; i++) {
      var openDropdown = dropdowns[i];
      if (openDropdown.classList.contains('show')) {
        openDropdown.classList.remove('show');
      }
    }
  }
}

function dropdown_content_clicked1(){
	var n = 1;
	load_dropdown_content(n);
}

function dropdown_content_clicked2(){
	var n = 2;
	load_dropdown_content(n);
}

function dropdown_content_clicked3(){
	var n = 3;
	load_dropdown_content(n);
}

function dropdown_content_clicked4(){
	var n = 4;
	load_dropdown_content(n);
}

function dropdown_content_clicked5(){
	var n = 5;
	load_dropdown_content(n);
}

function dropdown_content_clicked6(){
	var n = 6;
	load_dropdown_content(n);
}

function dropdown_content_clicked7(){
	var n = 7;
	load_dropdown_content(n);
}

function dropdown_content_clicked8(){
	var n = 8;
	load_dropdown_content(n);
}

function dropdown_content_clicked9(){
	var n = 9;
	load_dropdown_content(n);
}

function dropdown_content_clicked10(){
	var n = 10;
	load_dropdown_content(n);
}

function dropdown_content_clicked11(){
	var n = 11;
	load_dropdown_content(n);
}

function dropdown_content_clicked12(){
	var n = 12;
	load_dropdown_content(n);
}

function dropdown_content_clicked13(){
	var n = 13;
	load_dropdown_content(n);
}

function dropdown_content_clicked14(){
	var n = 14;
	load_dropdown_content(n);
}

function dropdown_content_clicked15(){
	var n = 15;
	load_dropdown_content(n);
}

function dropdown_content_clicked16(){
	var n = 16;
	load_dropdown_content(n);
}

function dropdown_content_clicked17(){
	var n = 17;
	load_dropdown_content(n);
}

function dropdown_content_clicked18(){
	var n = 18;
	load_dropdown_content(n);
}

function dropdown_content_clicked19(){
	var n = 19;
	load_dropdown_content(n);
}

function dropdown_content_clicked20(){
	var n = 20;
	load_dropdown_content(n);
}

function dropdown_content_clicked21(){
	var n = 21;
	load_dropdown_content(n);
}

function dropdown_content_clicked22(){
	var n = 22;
	load_dropdown_content(n);
}

function dropdown_content_clicked23(){
	var n = 23;
	load_dropdown_content(n);
}

function dropdown_content_clicked24(){
	var n = 24;
	load_dropdown_content(n);
}

function dropdown_content_clicked100(){
	var n = 100;
	load_dropdown_content(n);
}

function load_dropdown_content(n){
	var dd_id = document.getElementById("dd_id").value;
	var searchterm = "";
	if(dd_id === "category")
		searchterm = document.getElementById("c"+n).value;
	else
 		searchterm = document.getElementById("d"+n).value;

	var searchtype = dd_id;
	var s_value = document.getElementById("mysearch");
	s_value.value = searchterm;
	loadNames(searchtype);
}

function titlebtn(){
	var searchtype= "title";
	loadNames(searchtype);
}

function authorbtn(){
	var searchtype= "author";
	loadNames(searchtype);
}
    
  async function loadNames(searchtype) {
  var searchterm = document.getElementById('mysearch').value;

  //if no value entered
  if(searchterm === ""){
	alert("No value entered.");
  }
  else{
	

  const response = await fetch('https://raw.githubusercontent.com/stephenjtd/Json-Data/main/library3.json');
				//https://raw.githubusercontent.com/stephenjtd/Json-Data/main/library3.json
  const jdata = await response.json();
  console.log(jdata); 
  var string1 = JSON.stringify(jdata);
  const obj = JSON.parse(string1);
  //Create a HTML Table element.
  var myTable  = document.createElement("table");
  myTable.border = "1";

  //Add the header row.
  var row = myTable.insertRow(-1);
 
  //Add the header cells.
   var headerCell = document.createElement("TH");
   headerCell.innerHTML = "Results";
   row.appendChild(headerCell);

  var found = false;
  var f2 = false;
  var resultsFound = 0;
  const category_array = ["Fiction", "Contemporary Fiction", "Crime", "Historical-fiction", "Adult", "Romance", "Science Fiction", "Fantasy", "Thriller", "Young-adult", "Short Stories", "Anthologies", "Poetry", "Drama", "Non-fiction", "Biography", "Children's", "Picture Book", "Business", "Feminism", "History", "Religio", "Self-Help", "Travel"];    

  for (var i = 0; i < obj.length; i++) {
	 //document.getElementById("mydata").innerHTML = obj[i].Title + ", " + obj[i].Authors;
	//get searchtype
		
		if(searchtype.includes("title"))
			if(obj[i].Title.toLowerCase().includes(searchterm.toLowerCase()))
				found = true;
		if(searchtype.includes("author"))
			if(obj[i].Authors.toLowerCase().includes(searchterm.toLowerCase()))
				found = true;
		if(searchtype.includes("category"))
			if(obj[i].Categories.toLowerCase().includes(searchterm.toLowerCase()))
				found = true;
			else if(searchterm === "Others"){
				//look for book that does not have a dropdown menu category
				//check from array of categories
				var hascat = false;
				for (var j = 0; j < category_array.length; j++){
					if(obj[i].Categories.toLowerCase().includes(category_array[j].toLowerCase()))
						hascat = true;//category on list 
				}
				if(hascat == false)
					found = true;	
			}


		if(searchtype.includes("bookshelf"))
			if(obj[i].Bookshelf.includes(searchterm))
				found = true;
				
		
 		if(found){	
			f2 = true;
			//Add the data row.
            		var row = myTable.insertRow(-1);
 
            		//Add the data cells.

            		var cell = row.insertCell(-1);

			var details = "<b>" + obj[i].Title + "</b><br/>";
			if (!(obj[i].Subtitle === "")){
				//if title contains subtitle
				if (obj[i].Title.toLowerCase().includes(obj[i].Subtitle.toLowerCase()))
					;
				else
					details+= "<b>" + obj[i].Subtitle + "</b><br/>";
			}

			details += obj[i].Authors + "<br/>";

			//if book has illustrator
			if (!(obj[i].Illustrators === ""))
					if ((obj[i].Illustrators === "undefined"))
						;
					else
						details+= "Illustrated by " + obj[i].Illustrators + "<br/>";

			details += "<br/>Bookshelf: " + obj[i].Bookshelf + "<br/>Categories: " + obj[i].Categories;

			if (!(obj[i].Series === ""))
				details+= "<br/>Series: " + obj[i].Series;

			if (!(obj[i].Volume === ""))
				details+= "<br/>Volume: " + obj[i].Volume;

			details += "<br/>Publisher: " + obj[i].Publisher;

			
			//if (!(obj[i].Published_At === ""))
			//	details+= "<br/>Date Published: " + obj[i].Published_At;			
			
			if (!(obj[i].ISBN === ""))
				details+= "<br/>ISBN: " + obj[i].ISBN;

			if (!(obj[i].Format === ""))
 				details+= "<br/>" + obj[i].Format;

			//if (!(obj[i].Page_Count === ""))
 			//	details+= "<br/>" + obj[i].Page_Count;
			
			var testclick = false;
			details+= '<br/><input type="button" id="my_c'+i+'" class ="collapsible" value="Description" onclick="load_description('+i+')" /><div class="content" id="mydiv'+i+'"><p>' + obj[i].Description + '</p></div>';


			cell.innerHTML = details;
			resultsFound++;

			
		}
		
			

	found = false;
  }//for

	var resultsN = document.getElementById("results_number");
	//resultsN.insertAdjacentText('beforeend', resultsFound + ' results found.');
	resultsN.innerHTML = resultsFound + ' results found.';

        var Table1 = document.getElementById("MainTable");
        Table1.innerHTML = "";
        Table1.appendChild(myTable); 	

	if(f2){

 
	}
	else
		alert("Search value not found.");

  }//else
}//loadnames

function load_description(i){
	var coll = document.getElementById("my_c"+i);
	
    			var content = document.getElementById("mydiv"+i);
			//var content = this.nextElementSibling;
    			if (content.style.display === "block") {
     			 content.style.display = "none";
			 coll.value = "Description";
    			} else {
     			 content.style.display = "block";
			 coll.value = "Hide Description";
   			 }
			
  			
	
}


</script>
</body>

</html>
